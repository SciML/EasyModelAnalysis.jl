<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Designing Threshold Interventions ¬∑ EasyModelAnalysis.jl</title><meta name="title" content="Designing Threshold Interventions ¬∑ EasyModelAnalysis.jl"/><meta property="og:title" content="Designing Threshold Interventions ¬∑ EasyModelAnalysis.jl"/><meta property="twitter:title" content="Designing Threshold Interventions ¬∑ EasyModelAnalysis.jl"/><meta name="description" content="Documentation for EasyModelAnalysis.jl."/><meta property="og:description" content="Documentation for EasyModelAnalysis.jl."/><meta property="twitter:description" content="Documentation for EasyModelAnalysis.jl."/><meta property="og:url" content="https://docs.sciml.ai/EasyModelAnalysis/stable/tutorials/threshold_interventions/"/><meta property="twitter:url" content="https://docs.sciml.ai/EasyModelAnalysis/stable/tutorials/threshold_interventions/"/><link rel="canonical" href="https://docs.sciml.ai/EasyModelAnalysis/stable/tutorials/threshold_interventions/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="EasyModelAnalysis.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">EasyModelAnalysis.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">EasyModelAnalysis.jl: Quick and Easy Queries to Simulation Results</a></li><li><a class="tocitem" href="../../getting_started/">Getting Started with EasyModelAnalysis</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../sensitivity_analysis/">Sensitivity Analysis</a></li><li><a class="tocitem" href="../datafitting/">Calibrating Models to Data</a></li><li class="is-active"><a class="tocitem" href>Designing Threshold Interventions</a></li><li><a class="tocitem" href="../probabilistic_thresholds/">Analysis of Threshold Crossing Probabilities Under Uncertainty</a></li><li><a class="tocitem" href="../ensemble_modeling/">Ensemble Modeling</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../examples/petri/">AlgebraicPetri Integration</a></li><li><a class="tocitem" href="../../examples/ASIR/">Analysis of The Asymptomatic SIR Model</a></li><li><a class="tocitem" href="../../examples/SEIRHD/">Analysis of Interventions On The SEIRHD Epidemic Model</a></li><li><a class="tocitem" href="../../examples/Carcione2020/">Sensitivity Analysis of the Carcione2020 Epidemic Model</a></li></ul></li><li><span class="tocitem">Scenarios</span><ul><li><a class="tocitem" href="../../scenarios/scenario1/">Scenario 1: Vaccination</a></li><li><a class="tocitem" href="../../scenarios/scenario2/">Scenario 2: Limiting Hospitalizations</a></li><li><a class="tocitem" href="../../scenarios/scenario3/">Scenario 3: Limiting Deaths</a></li><li><a class="tocitem" href="../../scenarios/scenario4/">Scenario 4: Testing and Return to Campus</a></li><li><a class="tocitem" href="../../scenarios/scenario5/">Scenario 5: Bucky model</a></li></ul></li><li><span class="tocitem">API</span><ul><li><a class="tocitem" href="../../api/basic_queries/">Basic Queries</a></li><li><a class="tocitem" href="../../api/data_fitting_calibration/">Data Fitting and Model Calibration</a></li><li><a class="tocitem" href="../../api/sensitivity_analysis/">Sensitivity Analysis</a></li><li><a class="tocitem" href="../../api/threshold_interventions/">Threshold Interventions</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Designing Threshold Interventions</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Designing Threshold Interventions</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SciML/EasyModelAnalysis.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands">ÔÇõ</span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SciML/EasyModelAnalysis.jl/blob/main/docs/src/tutorials/threshold_interventions.md" title="Edit source on GitHub"><span class="docs-icon fa-solid">ÔÅÑ</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Designing-Threshold-Interventions"><a class="docs-heading-anchor" href="#Designing-Threshold-Interventions">Designing Threshold Interventions</a><a id="Designing-Threshold-Interventions-1"></a><a class="docs-heading-anchor-permalink" href="#Designing-Threshold-Interventions" title="Permalink"></a></h1><p>In this tutorial, we will demonstrate how to analyze ‚Äúthreshold interventions‚Äù, i.e., how to do calculations of model results to determine quantities around thresholds and the interventions to fix/avoid thresholds. Thresholds are meant to answer queries like ‚Äúwhat is the first time point where the number of COVID cases will cross 10% of the population?‚Äù, or ‚Äúwhen will the ball reach the wall?‚Äù. Intervention is then an assessment of policies around such thresholds. For example, ‚Äúwhen should we start and stop an enforced masking policy to keep the total number of COVID cases below 10% for the full-time period?‚Äù. Thus, these two analyses go hand in hand: threshold queries give us information about when thresholds will be reached, while intervention functions give us optimal strategies for avoiding such thresholds.</p><p>To see this in action, let&#39;s create a model of the population of rabbits in a post-apocalyptic Earth where fauna and humans have moved to Mars on SpaceX ships, but a few bunnies were accidentally left behind to use Earth as an approximately infinite food source. As you may recall from this model in elementary ecology courses, this is best defined by a linear ODE system, which we define in the ModelingToolkit sense:</p><pre><code class="language-julia hljs">using EasyModelAnalysis
@variables t üê∞(t)
@parameters p
D = Differential(t)
eqs = [D(üê∞) ~ p * üê∞]
@named sys = ODESystem(eqs)
prob = ODEProblem(sys, [üê∞ =&gt; 0.01], (0.0, 10.0), [p =&gt; 1.0])</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi"><span class="sgr38_2" style="color:#56b6c2">ODEProblem</span> with uType <span class="sgr38_2" style="color:#56b6c2">Vector{Float64}</span> and tType <span class="sgr38_2" style="color:#56b6c2">Float64</span>. In-place: <span class="sgr38_2" style="color:#56b6c2">true</span>
timespan: (0.0, 10.0)
u0: 1-element Vector{Float64}:
 0.01</code></pre><p>In this model <code>x(t)</code> is the number of billions of bunnies (commonly referred to in the units bB) and <code>t</code> is given in units of months. Solving this ODE shows the number of bunnies grows exponentially over time as they are all fat and happy with plenty of grass to feed on:</p><pre><code class="language-julia hljs">plot(solve(prob))</code></pre><img src="9e9f428a.svg" alt="Example block output"/><p>We can ask, how long does it take for this exponential growth to cause the continuous number of bunnies <code>x</code> to cross the value of 50bB? Let&#39;s ask:</p><pre><code class="language-julia hljs">get_threshold(prob, üê∞, 50)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">8.517445010816738</code></pre><p>Which, eyeballing the plot, looks correct: in about 8 and half months the population will reach 50 billion bunnies!</p><p>But now let&#39;s create an intervention. Let&#39;s say a corporation has created an ‚ÄúEarth viewing tourism‚Äù business where humans are watching the bunny population through a telescope. Market research has found that when there are more than 3bB in the population, the reaction goes from ‚Äúthat&#39;s cute‚Äù to ‚Äúeww too many rodents‚Äù, and thus to maximize their profits the corporation wants to fire a laser that indiscriminately kills bunnies at an exponential rate (which just happens to be the same rate as twice the growth of the bunny population). But as you probably know from experience, operating death rays that cover the distance from Mars to Earth cost a lot to operate, so the corporation wants to run this for as short as possible. The company knows they will get shut down after 50 months anyway once regulators catch up, so they only need to keep the planet looking cute for that short amount of time.</p><p>How should the bunny murder operation commence in order to successfully maximize corporate profits? To get the desired result, we use the <code>optimal_threshold_intervention</code> function. Our intervention will be to decrease the growth rate <span>$p = 1.0$</span> to <span>$p = -1.0$</span> (i.e. decrease it by twice the birth rate). What we want to know is what is the minimal time intervention to keep the population under 3bB until a time 50. Thus, the call looks as follows:</p><pre><code class="language-julia hljs">opt_tspan, (s1, s2, s3), ret = optimal_threshold_intervention(prob, [p =&gt; -1.0], üê∞, 3, 50);

opt_tspan</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2-element Vector{Float64}:
  5.153843896573885
 27.820237643963765</code></pre><p>The <code>opt_tspan</code> gives us the optimal timespan of the intervention: we should begin the decimation of bunny civilization when it reaches 5.15 months, and then we can turn the destruction device off at 27.8 months into our tourism operation. To see the effect of this, we can plot the results of the three sub-intervals:</p><pre><code class="language-julia hljs">plot(s1, lab = &quot;pre-intervention&quot;)
plot!(s2, lab = &quot;intervention&quot;)
plot!(s3, xlims = (0, s3.t[end]), ylims = (0, 5), lab = &quot;post-intervention&quot;, dpi = 300)</code></pre><img src="07c8a4b2.svg" alt="Example block output"/><p>Let&#39;s understand this result. Because of the exponential growth, we want to start the laser as late as possible as that will give us the most ‚Äúbang for the buck‚Äù, or rather, ‚Äúburn for the buck‚Äù, killing the most bunnies in the least amount of time. Thus, we want to wait for the population to grow a bit and be easier for the laser to hit. Then we leave the laser on for as short of a time as possible. By choosing 27.8 months as the off point, this will allow for the rest of the time to be tourism friendly. When regulators finally get in touch on the 50th month, the population will have exactly reached the 3bB tipping point, allowing us to fully use that entire time for unburned bunny tourism while also making regulators more sympathetic to our burning cause by the time they reach out to us.</p><p>Of course, this could also be used to uncover optimal policies for handling pandemics, but whatever your desired use case is, churn away.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../datafitting/">¬´ Calibrating Models to Data</a><a class="docs-footer-nextpage" href="../probabilistic_thresholds/">Analysis of Threshold Crossing Probabilities Under Uncertainty ¬ª</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.3.0 on <span class="colophon-date" title="Monday 8 April 2024 01:20">Monday 8 April 2024</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
